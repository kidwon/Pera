(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,82373,75254,60651,761,80157,e=>{"use strict";var t=e.i(71645);let s=(...e)=>e.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim(),a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)};var r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,t.forwardRef)(({color:e="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:n,className:l="",children:d,iconNode:o,...c},u)=>(0,t.createElement)("svg",{ref:u,...r,width:a,height:a,stroke:e,strokeWidth:n?24*Number(i)/Number(a):i,className:s("lucide",l),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1})(c)&&{"aria-hidden":"true"},...c},[...o.map(([e,s])=>(0,t.createElement)(e,s)),...Array.isArray(d)?d:[d]])),n=(e,r)=>{let n=(0,t.forwardRef)(({className:n,...l},d)=>(0,t.createElement)(i,{ref:d,iconNode:r,className:s(`lucide-${a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,n),...l}));return n.displayName=a(e),n};e.s(["default",()=>n],75254);let l=n("volume-2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);e.s(["Volume2",()=>l],82373),e.s(["useTTS",0,()=>({speak:(0,t.useCallback)(e=>{if(!("speechSynthesis"in window))return void console.warn("Text-to-speech not supported");let t=new SpeechSynthesisUtterance(e);t.lang="ja-JP",window.speechSynthesis.speak(t)},[]),isSupported:"speechSynthesis"in window})],60651);var d=e.i(43476);function o({query:e,width:s=640,height:a=360,components:r=72}){let i=(0,t.useRef)(null),n="youglish-widget";return(0,t.useEffect)(()=>{if(!document.getElementById("youglish-script")){let e=document.createElement("script");e.id="youglish-script",e.src="https://youglish.com/public/emb/widget.js",e.async=!0,document.body.appendChild(e)}let t=setInterval(()=>{if(window.YG){if(window.YG&&!i.current)try{i.current=new window.YG.Widget(n,{width:s,components:r,events:{onError:e=>console.error("YouGlish Error:",e)}}),e&&i.current.fetch(e,"japanese")}catch(e){console.error("Error initializing YouGlish widget:",e)}clearInterval(t)}},100);return()=>clearInterval(t)},[]),(0,t.useEffect)(()=>{i.current&&e&&i.current.fetch(e,"japanese")},[e]),(0,d.jsx)("div",{className:"flex justify-center items-center w-full my-4",children:(0,d.jsx)("div",{id:n,style:{minHeight:a}})})}e.s(["YouGlishPlayer",()=>o],761);var c=e.i(49589),u=e.i(19455);let m=n("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);function h(){let{language:e,setLanguage:t}=(0,c.useLanguage)();return(0,d.jsxs)(u.Button,{variant:"ghost",size:"sm",className:"flex items-center gap-2",onClick:()=>t("zh"===e?"en":"zh"),children:[(0,d.jsx)(m,{className:"h-4 w-4"}),(0,d.jsx)("span",{children:"zh"===e?"EN":"中文"})]})}e.s(["LanguageSwitcher",()=>h],80157)},15288,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(75157);let r=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("rounded-xl border bg-card text-card-foreground shadow",e),...s}));r.displayName="Card";let i=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...s}));i.displayName="CardHeader";let n=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("h3",{ref:r,className:(0,a.cn)("font-semibold leading-none tracking-tight",e),...s}));n.displayName="CardTitle",s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("p",{ref:r,className:(0,a.cn)("text-sm text-muted-foreground",e),...s})).displayName="CardDescription";let l=s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("p-6 pt-0",e),...s}));l.displayName="CardContent",s.forwardRef(({className:e,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter",e.s(["Card",()=>r,"CardContent",()=>l,"CardHeader",()=>i,"CardTitle",()=>n])},90454,e=>{"use strict";e.i(47167);var t=e.i(43476),s=e.i(71645);e.i(50711);var a=e.i(82045),r=e.i(83394),i=e.i(75157);let n=s.forwardRef(({className:e,type:s,...a},r)=>(0,t.jsx)("input",{type:s,className:(0,i.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...a}));n.displayName="Input";var l=e.i(19455),d=e.i(15288),o=e.i(75254);let c=(0,o.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),u=(0,o.default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var m=e.i(82373);let h=(0,o.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var x=e.i(60651);let f=(0,o.default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function p({isOpen:e,onClose:a,children:r,title:i}){let n=(0,s.useRef)(null);return((0,s.useEffect)(()=>{let t=e=>{"Escape"===e.key&&a()};return e?(document.body.style.overflow="hidden",window.addEventListener("keydown",t)):(document.body.style.overflow="unset",window.removeEventListener("keydown",t)),()=>{document.body.style.overflow="unset",window.removeEventListener("keydown",t)}},[e,a]),e)?(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:[(0,t.jsxs)("div",{ref:n,className:"relative w-full max-w-lg max-h-[90vh] overflow-y-auto rounded-lg bg-background p-6 shadow-lg",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold",children:i}),(0,t.jsx)(l.Button,{variant:"ghost",size:"icon",onClick:a,children:(0,t.jsx)(f,{className:"h-5 w-5"})})]}),r]}),(0,t.jsx)("div",{className:"fixed inset-0 -z-10",onClick:a})]}):null}var g=e.i(761),v=e.i(49589),j=e.i(80157);let y=s.createContext(null);function w({defaultValue:e,value:a,onValueChange:r,className:n,children:l,...d}){let[o,c]=s.useState(e);return(0,t.jsx)(y.Provider,{value:{value:void 0!==a?a:o,onValueChange:r||c},children:(0,t.jsx)("div",{className:(0,i.cn)("w-full",n),...d,children:l})})}function N({className:e,...s}){return(0,t.jsx)("div",{className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s})}function b({value:e,className:a,...r}){let n=s.useContext(y);if(!n)throw Error("TabsTrigger must be used within Tabs");let l=n.value===e;return(0,t.jsx)("button",{type:"button",role:"tab","aria-selected":l,onClick:()=>n.onValueChange(e),className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",l?"bg-background text-foreground shadow-sm":"hover:bg-background/50 hover:text-foreground",a),...r})}function k({value:e,className:a,...r}){let n=s.useContext(y);if(!n)throw Error("TabsContent must be used within Tabs");return n.value!==e?null:(0,t.jsx)("div",{role:"tabpanel",className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...r})}function C(){let{t:e}=(0,v.useLanguage)(),[i,o]=(0,s.useState)(""),[f,y]=(0,s.useState)([]),[C,S]=(0,s.useState)(!1),[E,T]=(0,s.useState)(null),[z,M]=(0,s.useState)(!1),[R,P]=(0,s.useState)("search"),$=(0,a.useMutation)(r.api.cards.addCard),B=(0,a.useMutation)(r.api.cards.removeCard),L=(0,a.useQuery)(r.api.cards.getAllCards),{speak:q}=(0,x.useTTS)(),A=(0,s.useMemo)(()=>{let e=new Set;return L&&L.forEach(t=>{e.add(`${t.ent_seq}:${t.meaningIndex}`)}),e},[L]);(0,s.useEffect)(()=>{let e=setTimeout(async()=>{if(!i.trim())return void y([]);S(!0);try{let e=await fetch(`https://advisory-clinic-expressed-demands.trycloudflare.com/api/dictionary/search?q=${encodeURIComponent(i)}`);if(e.ok){let t=await e.json();y(t)}else y([])}catch(e){console.error("Search failed:",e),y([])}finally{S(!1)}},300);return()=>clearTimeout(e)},[i]);let V=async(e,t)=>{try{await $({ent_seq:e.ent_seq,kanji:e.kanji,reading:e.reading,meanings:[e.meanings[t]],pitch:e.pitch??void 0,meaningIndex:t})}catch(t){console.error("Failed to add card:",t);let e=t.message||JSON.stringify(t);alert(`Failed to add card: ${e}`)}},_=async(t,s)=>{if(s.stopPropagation(),confirm(e.confirmRemove||"Remove this card?"))try{await B({cardId:t})}catch(e){console.error("Failed to remove card:",e)}},I=e=>{T(e),M(!1)};return(0,t.jsxs)("div",{className:"container mx-auto max-w-2xl p-4 min-h-screen pb-20",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-center flex-1 ml-10",children:e.appName}),(0,t.jsx)(j.LanguageSwitcher,{})]}),(0,t.jsxs)(w,{defaultValue:"search",value:R,onValueChange:P,className:"w-full",children:[(0,t.jsxs)(N,{className:"grid w-full grid-cols-2 mb-4",children:[(0,t.jsx)(b,{value:"search",children:e.searchTab}),(0,t.jsx)(b,{value:"myCards",children:e.myCardsTab})]}),(0,t.jsxs)(k,{value:"search",className:"mt-0",children:[(0,t.jsx)("div",{className:"sticky top-0 bg-background/95 backdrop-blur py-4 z-10",children:(0,t.jsx)(n,{placeholder:e.searchPlaceholder,value:i,onChange:e=>o(e.target.value),className:"text-lg h-12",autoFocus:!0})}),(0,t.jsxs)("div",{className:"mt-4 space-y-4",children:[C&&(0,t.jsx)("div",{className:"text-center text-muted-foreground animate-pulse",children:"..."}),!C&&0===f.length&&""!==i.trim()&&(0,t.jsx)("div",{className:"text-center text-muted-foreground",children:e.noCards}),f.map(e=>{let s=A.has(`${e.ent_seq}:0`);return(0,t.jsx)(d.Card,{className:"overflow-hidden hover:shadow-md transition-shadow cursor-pointer",onClick:()=>I(e),children:(0,t.jsxs)(d.CardContent,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-2xl font-bold text-primary",children:e.kanji||e.reading}),e.kanji&&e.reading&&(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:["(",e.reading,e.pitch?` [${e.pitch}]`:"",")"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l.Button,{variant:"ghost",size:"icon",disabled:s,className:`h-8 w-8 ${s?"text-primary opacity-50":"text-muted-foreground hover:text-primary"}`,onClick:t=>{t.stopPropagation(),s||V(e,0)},children:s?(0,t.jsx)(u,{className:"h-5 w-5"}):(0,t.jsx)(c,{className:"h-5 w-5"})}),(0,t.jsx)(l.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-primary",onClick:t=>{t.stopPropagation(),q(e.reading||e.kanji||"")},children:(0,t.jsx)(m.Volume2,{className:"h-4 w-4"})})]})]}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground line-clamp-2",children:e.meanings.map(e=>e.gloss).join("; ")})]})},e.ent_seq)})]})]}),(0,t.jsx)(k,{value:"myCards",className:"mt-0",children:(0,t.jsxs)("div",{className:"mt-4 space-y-4",children:[void 0===L&&(0,t.jsx)("div",{className:"text-center text-muted-foreground animate-pulse",children:"..."}),L&&0===L.length&&(0,t.jsx)("div",{className:"text-center py-10 text-muted-foreground",children:e.noSavedCards}),L?.map(e=>(0,t.jsx)(d.Card,{className:"overflow-hidden hover:shadow-md transition-shadow cursor-pointer relative group",onClick:()=>I(e),children:(0,t.jsxs)(d.CardContent,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-xl font-bold text-primary",children:e.kanji||e.reading}),e.kanji&&e.reading&&(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",e.reading,")"]})]}),(0,t.jsx)(l.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive transition-opacity",onClick:t=>_(e._id,t),children:(0,t.jsx)(h,{className:"h-4 w-4"})})]}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:e.meanings.map(e=>e.gloss).join("; ")})]})},e._id))]})})]}),E&&(0,t.jsx)(p,{isOpen:!!E,onClose:()=>{T(null),M(!1)},title:E.kanji||E.reading||"",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"text-center space-y-2",children:[(0,t.jsx)("div",{className:"text-4xl font-bold text-primary",children:E.kanji||E.reading}),(0,t.jsxs)("div",{className:"text-xl text-muted-foreground flex items-center justify-center gap-2",children:[E.reading,E.pitch&&(0,t.jsx)("span",{className:"text-sm border px-1 rounded",children:E.pitch}),(0,t.jsx)(l.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-primary",onClick:e=>{e.stopPropagation(),q(E.reading||E.kanji||"")},children:(0,t.jsx)(m.Volume2,{className:"h-5 w-5"})})]})]}),(0,t.jsx)("div",{className:"space-y-4",children:E.meanings.map((s,a)=>{let r=`${E.ent_seq}:${a}`,i=A.has(r);return(0,t.jsxs)("div",{className:"p-3 rounded-md bg-muted/30 border",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,t.jsxs)("span",{className:"font-medium text-lg text-primary/90",children:[a+1,". ",s.gloss]}),(0,t.jsxs)(l.Button,{size:"sm",variant:i?"secondary":"outline",onClick:e=>{e.stopPropagation(),V(E,a)},disabled:i,className:"gap-1 h-8",children:[i?(0,t.jsx)(u,{className:"h-3 w-3"}):(0,t.jsx)(c,{className:"h-3 w-3"}),i?e.added:e.addCard]})]}),s.examples&&s.examples.length>0&&(0,t.jsx)("div",{className:"mt-2 text-sm text-muted-foreground/90 pl-3 border-l-2 border-primary/20 space-y-2",children:s.examples.map((e,s)=>(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"italic text-foreground/90",children:e.text}),(0,t.jsx)("div",{className:"opacity-75 text-xs font-medium",children:e.text_ja})]},s))})]},a)})}),(0,t.jsxs)("div",{className:"pt-4 border-t flex flex-col gap-3",children:[(0,t.jsx)(l.Button,{variant:z?"secondary":"outline",className:"w-full gap-2",onClick:()=>M(!z),children:e.examplesVideo}),z&&(0,t.jsx)("div",{className:"mt-4 animate-in fade-in zoom-in-95 duration-300",children:(0,t.jsx)(g.YouGlishPlayer,{query:E.kanji||E.reading||""})})]})]})})]})}e.s(["default",()=>C],90454)}]);