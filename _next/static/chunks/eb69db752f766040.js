(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(75157);let n=s.forwardRef(({className:e,...s},n)=>(0,t.jsx)("div",{ref:n,className:(0,a.cn)("rounded-xl border bg-card text-card-foreground shadow",e),...s}));n.displayName="Card";let r=s.forwardRef(({className:e,...s},n)=>(0,t.jsx)("div",{ref:n,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...s}));r.displayName="CardHeader";let i=s.forwardRef(({className:e,...s},n)=>(0,t.jsx)("h3",{ref:n,className:(0,a.cn)("font-semibold leading-none tracking-tight",e),...s}));i.displayName="CardTitle";let l=s.forwardRef(({className:e,...s},n)=>(0,t.jsx)("p",{ref:n,className:(0,a.cn)("text-sm text-muted-foreground",e),...s}));l.displayName="CardDescription";let o=s.forwardRef(({className:e,...s},n)=>(0,t.jsx)("div",{ref:n,className:(0,a.cn)("p-6 pt-0",e),...s}));o.displayName="CardContent",s.forwardRef(({className:e,...s},n)=>(0,t.jsx)("div",{ref:n,className:(0,a.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter",e.s(["Card",()=>n,"CardContent",()=>o,"CardDescription",()=>l,"CardHeader",()=>r,"CardTitle",()=>i])},90454,e=>{"use strict";e.i(47167);var t=e.i(43476),s=e.i(46932),a=e.i(71645),n=e.i(31178),r=e.i(47414),i=e.i(74008),l=e.i(21476),o=e.i(72846),d=a,c=e.i(37806);function u(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class m extends d.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent&&!1!==this.props.pop){let e=t.offsetParent,s=(0,o.isHTMLElement)(e)&&e.offsetWidth||0,a=(0,o.isHTMLElement)(e)&&e.offsetHeight||0,n=this.props.sizeRef.current;n.height=t.offsetHeight||0,n.width=t.offsetWidth||0,n.top=t.offsetTop,n.left=t.offsetLeft,n.right=s-n.width-n.left,n.bottom=a-n.height-n.top}return null}componentDidUpdate(){}render(){return this.props.children}}function h({children:e,isPresent:s,anchorX:n,anchorY:r,root:i,pop:l}){let o=(0,d.useId)(),h=(0,d.useRef)(null),p=(0,d.useRef)({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:x}=(0,d.useContext)(c.MotionConfigContext),f=function(...e){return a.useCallback(function(...e){return t=>{let s=!1,a=e.map(e=>{let a=u(e,t);return s||"function"!=typeof a||(s=!0),a});if(s)return()=>{for(let t=0;t<a.length;t++){let s=a[t];"function"==typeof s?s():u(e[t],null)}}}}(...e),e)}(h,e.props?.ref??e?.ref);return(0,d.useInsertionEffect)(()=>{let{width:e,height:t,top:a,left:d,right:c,bottom:u}=p.current;if(s||!1===l||!h.current||!e||!t)return;let m="left"===n?`left: ${d}`:`right: ${c}`,f="bottom"===r?`bottom: ${u}`:`top: ${a}`;h.current.dataset.motionPopId=o;let g=document.createElement("style");x&&(g.nonce=x);let v=i??document.head;return v.appendChild(g),g.sheet&&g.sheet.insertRule(`
          [data-motion-pop-id="${o}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${t}px !important;
            ${m}px !important;
            ${f}px !important;
          }
        `),()=>{v.contains(g)&&v.removeChild(g)}},[s]),(0,t.jsx)(m,{isPresent:s,childRef:h,sizeRef:p,pop:l,children:!1===l?e:d.cloneElement(e,{ref:f})})}let p=({children:e,initial:s,isPresent:n,onExitComplete:i,custom:o,presenceAffectsLayout:d,mode:c,anchorX:u,anchorY:m,root:p})=>{let f=(0,r.useConstant)(x),g=(0,a.useId)(),v=!0,j=(0,a.useMemo)(()=>(v=!1,{id:g,initial:s,isPresent:n,custom:o,onExitComplete:e=>{for(let t of(f.set(e,!0),f.values()))if(!t)return;i&&i()},register:e=>(f.set(e,!1),()=>f.delete(e))}),[n,f,i]);return d&&v&&(j={...j}),(0,a.useMemo)(()=>{f.forEach((e,t)=>f.set(t,!1))},[n]),a.useEffect(()=>{n||f.size||!i||i()},[n]),e=(0,t.jsx)(h,{pop:"popLayout"===c,isPresent:n,anchorX:u,anchorY:m,root:p,children:e}),(0,t.jsx)(l.PresenceContext.Provider,{value:j,children:e})};function x(){return new Map}var f=e.i(64978);let g=e=>e.key||"";function v(e){let t=[];return a.Children.forEach(e,e=>{(0,a.isValidElement)(e)&&t.push(e)}),t}let j=({children:e,custom:s,initial:l=!0,onExitComplete:o,presenceAffectsLayout:d=!0,mode:c="sync",propagate:u=!1,anchorX:m="left",anchorY:h="top",root:x})=>{let[j,y]=(0,f.usePresence)(u),b=(0,a.useMemo)(()=>v(e),[e]),N=u&&!j?[]:b.map(g),w=(0,a.useRef)(!0),C=(0,a.useRef)(b),k=(0,r.useConstant)(()=>new Map),L=(0,a.useRef)(new Set),[R,$]=(0,a.useState)(b),[E,M]=(0,a.useState)(b);(0,i.useIsomorphicLayoutEffect)(()=>{w.current=!1,C.current=b;for(let e=0;e<E.length;e++){let t=g(E[e]);N.includes(t)?(k.delete(t),L.current.delete(t)):!0!==k.get(t)&&k.set(t,!1)}},[E,N.length,N.join("-")]);let P=[];if(b!==R){let e=[...b];for(let t=0;t<E.length;t++){let s=E[t],a=g(s);N.includes(a)||(e.splice(t,0,s),P.push(s))}return"wait"===c&&P.length&&(e=P),M(v(e)),$(b),null}let{forceRender:T}=(0,a.useContext)(n.LayoutGroupContext);return(0,t.jsx)(t.Fragment,{children:E.map(e=>{let a=g(e),n=(!u||!!j)&&(b===E||N.includes(a));return(0,t.jsx)(p,{isPresent:n,initial:(!w.current||!!l)&&void 0,custom:s,presenceAffectsLayout:d,mode:c,root:x,onExitComplete:n?void 0:()=>{if(L.current.has(a)||(L.current.add(a),!k.has(a)))return;k.set(a,!0);let e=!0;k.forEach(t=>{t||(e=!1)}),e&&(T?.(),M(C.current),u&&y?.(),o&&o())},anchorX:m,anchorY:h,children:e},a)})})};e.i(50711);var y=e.i(82045),b=e.i(83394),N=e.i(75157);let w=a.forwardRef(({className:e,type:s,...a},n)=>(0,t.jsx)("input",{type:s,className:(0,N.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...a}));w.displayName="Input";var C=e.i(19455),k=e.i(15288),L=e.i(75254);let R=(0,L.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),$=(0,L.default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var E=e.i(82373);let M=(0,L.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var P=e.i(60651);let T=(0,L.default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function S({isOpen:e,onClose:s,children:n,title:r}){let i=(0,a.useRef)(null);return((0,a.useEffect)(()=>{let t=e=>{"Escape"===e.key&&s()};return e?(document.body.style.overflow="hidden",window.addEventListener("keydown",t)):(document.body.style.overflow="unset",window.removeEventListener("keydown",t)),()=>{document.body.style.overflow="unset",window.removeEventListener("keydown",t)}},[e,s]),e)?(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:[(0,t.jsxs)("div",{ref:i,className:"relative w-full max-w-lg max-h-[90vh] overflow-y-auto rounded-lg bg-background p-6 shadow-lg",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold",children:r}),(0,t.jsx)(C.Button,{variant:"ghost",size:"icon",onClick:s,children:(0,t.jsx)(T,{className:"h-5 w-5"})})]}),n]}),(0,t.jsx)("div",{className:"fixed inset-0 -z-10",onClick:s})]}):null}var z=e.i(761),_=e.i(49589),B=e.i(80157);let V=a.createContext(null);function I({defaultValue:e,value:s,onValueChange:n,className:r,children:i,...l}){let[o,d]=a.useState(e);return(0,t.jsx)(V.Provider,{value:{value:void 0!==s?s:o,onValueChange:n||d},children:(0,t.jsx)("div",{className:(0,N.cn)("w-full",r),...l,children:i})})}function q({className:e,...s}){return(0,t.jsx)("div",{className:(0,N.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s})}function H({value:e,className:s,...n}){let r=a.useContext(V);if(!r)throw Error("TabsTrigger must be used within Tabs");let i=r.value===e;return(0,t.jsx)("button",{type:"button",role:"tab","aria-selected":i,onClick:()=>r.onValueChange(e),className:(0,N.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",i?"bg-background text-foreground shadow-sm":"hover:bg-background/50 hover:text-foreground",s),...n})}function F({value:e,className:s,...n}){let r=a.useContext(V);if(!r)throw Error("TabsContent must be used within Tabs");return r.value!==e?null:(0,t.jsx)("div",{role:"tabpanel",className:(0,N.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...n})}let U=e=>{switch(e?.toUpperCase()){case"N5":return"bg-blue-100 text-blue-800 border-blue-200";case"N4":return"bg-green-100 text-green-800 border-green-200";case"N3":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"N2":return"bg-orange-100 text-orange-800 border-orange-200";case"N1":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},A={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},O={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};function D(){let{t:e}=(0,_.useLanguage)(),[n,r]=(0,a.useState)(""),[i,l]=(0,a.useState)([]),[o,d]=(0,a.useState)(!1),[c,u]=(0,a.useState)(null),[m,h]=(0,a.useState)(!1),[p,x]=(0,a.useState)("search"),[f,g]=(0,a.useState)(null),v=(0,y.useMutation)(b.api.cards.addCard),N=(0,y.useMutation)(b.api.cards.removeCard),L=(0,y.useQuery)(b.api.cards.getAllCards),{speak:T}=(0,P.useTTS)(),V=(0,a.useMemo)(()=>L?f?L.filter(e=>e.jlptLevel===f):L:[],[L,f]),D=(0,a.useMemo)(()=>{let e=new Set;return L&&L.forEach(t=>{e.add(`${t.ent_seq}:${t.meaningIndex}`)}),e},[L]);(0,a.useEffect)(()=>{let e=setTimeout(async()=>{if(!n.trim())return void l([]);d(!0);try{let e=await fetch(`https://api.perapera.me/api/dictionary/search?q=${encodeURIComponent(n)}`);if(e.ok){let t=await e.json();l(t)}else l([])}catch(e){console.error("Search failed:",e),l([])}finally{d(!1)}},300);return()=>clearTimeout(e)},[n]);let Y=async(e,t)=>{try{await v({ent_seq:e.ent_seq,kanji:e.kanji,reading:e.reading,meanings:[e.meanings[t]],pitch:e.pitch??void 0,meaningIndex:t,jlptLevel:e.jlptLevel})}catch(t){console.error("Failed to add card:",t);let e=t.message||JSON.stringify(t);alert(`Failed to add card: ${e}`)}},G=async(t,s)=>{if(s.stopPropagation(),confirm(e.confirmRemove||"Remove this card?"))try{await N({cardId:t})}catch(e){console.error("Failed to remove card:",e)}},K=e=>{u(e),h(!1)};return(0,t.jsxs)("div",{className:"container mx-auto max-w-2xl p-4 min-h-screen pb-20",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-center flex-1 ml-10",children:e.appName}),(0,t.jsx)(B.LanguageSwitcher,{})]}),(0,t.jsxs)(I,{defaultValue:"search",value:p,onValueChange:x,className:"w-full",children:[(0,t.jsxs)(q,{className:"grid w-full grid-cols-2 mb-4",children:[(0,t.jsx)(H,{value:"search",children:e.searchTab}),(0,t.jsx)(H,{value:"myCards",children:e.myCardsTab})]}),(0,t.jsxs)(F,{value:"search",className:"mt-0",children:[(0,t.jsx)("div",{className:"sticky top-0 bg-background/95 backdrop-blur py-4 z-10",children:(0,t.jsx)(w,{placeholder:e.searchPlaceholder,value:n,onChange:e=>r(e.target.value),className:"text-lg h-12",autoFocus:!0})}),(0,t.jsxs)("div",{className:"mt-4 space-y-4",children:[o&&(0,t.jsx)("div",{className:"text-center text-muted-foreground animate-pulse",children:"..."}),!o&&0===i.length&&""!==n.trim()&&(0,t.jsx)("div",{className:"text-center text-muted-foreground",children:e.noCards}),i.map(e=>{let s=D.has(`${e.ent_seq}:0`);return(0,t.jsx)(k.Card,{className:"overflow-hidden hover:shadow-md transition-shadow cursor-pointer",onClick:()=>K(e),children:(0,t.jsxs)(k.CardContent,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-2xl font-bold text-primary",children:e.kanji||e.reading}),e.kanji&&e.reading&&(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:["(",e.reading,e.pitch?` [${e.pitch}]`:"",")"]}),e.jlptLevel&&(0,t.jsx)("span",{className:`text-[10px] px-1.5 py-0.5 rounded-full border font-medium ${U(e.jlptLevel)}`,children:e.jlptLevel})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(C.Button,{variant:"ghost",size:"icon",disabled:s,className:`h-8 w-8 ${s?"text-primary opacity-50":"text-muted-foreground hover:text-primary"}`,onClick:t=>{t.stopPropagation(),s||Y(e,0)},children:s?(0,t.jsx)($,{className:"h-5 w-5"}):(0,t.jsx)(R,{className:"h-5 w-5"})}),(0,t.jsx)(C.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-primary",onClick:t=>{t.stopPropagation(),T(e.reading||e.kanji||"")},children:(0,t.jsx)(E.Volume2,{className:"h-4 w-4"})})]})]}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground line-clamp-2",children:e.meanings.map((s,a)=>(0,t.jsxs)("span",{children:[s.gloss_cn?(0,t.jsxs)("span",{className:"text-primary/80 font-medium",children:["[",s.gloss_cn,"] "]}):null,s.gloss,a<e.meanings.length-1?"; ":""]},a))})]})},e.ent_seq)})]})]}),(0,t.jsxs)(F,{value:"myCards",className:"mt-0",children:[(0,t.jsx)("div",{className:"sticky top-0 bg-background/95 backdrop-blur py-4 z-10",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 justify-center",children:[(0,t.jsx)(C.Button,{variant:null===f?"default":"outline",size:"sm",onClick:()=>g(null),className:"h-8 px-3",children:"All"}),["N5","N4","N3","N2","N1"].map(e=>(0,t.jsx)(C.Button,{variant:f===e?"default":"outline",size:"sm",onClick:()=>g(e),className:`h-8 px-3 ${f===e?"":U(e)}`,children:e},e))]})}),(0,t.jsxs)("div",{className:"mt-4 space-y-4",children:[void 0===L&&(0,t.jsx)("div",{className:"text-center text-muted-foreground animate-pulse",children:"..."}),L&&0===V.length&&(0,t.jsx)("div",{className:"text-center py-10 text-muted-foreground",children:f?`No ${f} cards`:e.noSavedCards}),(0,t.jsx)(s.motion.div,{variants:A,initial:"hidden",animate:"show",className:"space-y-4",children:(0,t.jsx)(j,{mode:"popLayout",children:V?.map(e=>(0,t.jsx)(s.motion.div,{variants:O,layout:!0,initial:"hidden",animate:"show",exit:{opacity:0,scale:.9,transition:{duration:.2}},children:(0,t.jsx)(k.Card,{className:"overflow-hidden hover:shadow-md transition-shadow cursor-pointer relative group",onClick:()=>K(e),children:(0,t.jsxs)(k.CardContent,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-xl font-bold text-primary",children:e.kanji||e.reading}),(0,t.jsxs)("div",{className:"flex items-baseline gap-2",children:[e.kanji&&e.reading&&(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",e.reading,")"]}),e.jlptLevel&&(0,t.jsx)("span",{className:`text-[10px] px-1.5 py-0.5 rounded-full border font-medium ${U(e.jlptLevel)}`,children:e.jlptLevel})]})]}),(0,t.jsx)(C.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive transition-opacity",onClick:t=>G(e._id,t),children:(0,t.jsx)(M,{className:"h-4 w-4"})})]}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:e.meanings.map((s,a)=>(0,t.jsxs)("span",{children:[s.gloss_cn?(0,t.jsxs)("span",{className:"text-primary/80 font-medium",children:["[",s.gloss_cn,"] "]}):null,s.gloss,a<e.meanings.length-1?"; ":""]},a))})]})})},e._id))})})]})]})]}),c&&(0,t.jsx)(S,{isOpen:!!c,onClose:()=>{u(null),h(!1)},title:c.kanji||c.reading||"",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"text-center space-y-2",children:[(0,t.jsx)("div",{className:"text-4xl font-bold text-primary",children:c.kanji||c.reading}),(0,t.jsxs)("div",{className:"text-xl text-muted-foreground flex items-center justify-center gap-2",children:[c.reading,c.pitch&&(0,t.jsx)("span",{className:"text-sm border px-1 rounded",children:c.pitch}),c.jlptLevel&&(0,t.jsx)("span",{className:`text-sm px-2 py-0.5 rounded-full border font-medium ${U(c.jlptLevel)}`,children:c.jlptLevel}),(0,t.jsx)(C.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-primary",onClick:e=>{e.stopPropagation(),T(c.reading||c.kanji||"")},children:(0,t.jsx)(E.Volume2,{className:"h-5 w-5"})})]})]}),(0,t.jsx)("div",{className:"space-y-4",children:c.meanings.map((s,a)=>{let n=`${c.ent_seq}:${a}`,r=D.has(n);return(0,t.jsxs)("div",{className:"p-3 rounded-md bg-muted/30 border",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[s.gloss_cn&&(0,t.jsx)("div",{className:"text-xl font-bold text-primary",children:s.gloss_cn}),(0,t.jsxs)("div",{className:"text-muted-foreground",children:[a+1,". ",s.gloss]})]}),(0,t.jsxs)(C.Button,{size:"sm",variant:r?"secondary":"outline",onClick:e=>{e.stopPropagation(),Y(c,a)},disabled:r,className:"gap-1 h-8",children:[r?(0,t.jsx)($,{className:"h-3 w-3"}):(0,t.jsx)(R,{className:"h-3 w-3"}),r?e.added:e.addCard]})]}),s.examples&&s.examples.length>0&&(0,t.jsx)("div",{className:"mt-2 text-sm text-muted-foreground/90 pl-3 border-l-2 border-primary/20 space-y-2",children:s.examples.map((e,s)=>(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"italic text-foreground/90",children:e.text}),(0,t.jsx)("div",{className:"opacity-75 text-xs font-medium",children:e.text_ja})]},s))})]},a)})}),(0,t.jsxs)("div",{className:"pt-4 border-t flex flex-col gap-3",children:[(0,t.jsx)(C.Button,{variant:m?"secondary":"outline",className:"w-full gap-2",onClick:()=>h(!m),children:e.examplesVideo}),m&&(0,t.jsx)("div",{className:"mt-4 animate-in fade-in zoom-in-95 duration-300",children:(0,t.jsx)(z.YouGlishPlayer,{query:c.kanji||c.reading||""})})]})]})})]})}e.s(["default",()=>D],90454)}]);